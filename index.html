<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive South Korea Trip Planner with AI Features</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral (Slate, Stone, Amber) -->
    <!-- Application Structure Plan: A tabbed, single-page dashboard design was chosen over a linear report structure to provide non-linear, task-oriented access to information. Users can instantly jump to the daily itinerary, food guide, or logistics without extensive scrolling. The core interaction is an expandable card for each day's schedule, making the detailed plan easily accessible. This structure is optimized for on-the-go use by a traveler who needs quick answers. Gemini API features are integrated directly into relevant sections (Itinerary tweaks) and as a new, dedicated 'Culture' tab for Q&A. -->
    <!-- Visualization & Content Choices: Report Info: Airport Transport Table -> Goal: Compare options -> Viz: Interactive Bar Chart (Chart.js) -> Interaction: Hover tooltips -> Justification: Visually more intuitive and engaging for comparing quantitative data (cost/time) than a static table. Report Info: Daily Itinerary Text -> Goal: Organize daily plan -> Viz: Expandable HTML/CSS Cards -> Interaction: Click to expand/collapse -> Justification: Hides complexity, allows users to focus on one day at a time, better for mobile viewing. Report Info: Gemini API Integration -> Goal: Provide dynamic, personalized travel advice -> Viz: Modal pop-ups and dedicated Q&A section -> Interaction: Button clicks and text input -> Justification: Integrates AI assistance seamlessly without cluttering the main UI, providing on-demand intelligence. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .tab-active { 
            border-color: #f59e0b; 
            color: #f59e0b;
            background-color: #fffbeb;
        }
        .section { display: none; }
        .section.active { display: block; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 400px; /* Increased height for better aspect ratio */
        }
        .day-card-header { transition: background-color: 0.3s ease; }
        .day-card-header:hover { background-color: #f7fafc; }
        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-in-out;
        }
        .details-content.open {
            max-height: 2500px;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 1rem;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #f59e0b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .location-link {
            color: #d97706;
            text-decoration: underline;
            font-weight: 500;
        }
        .location-link:hover {
            color: #b45309;
        }
    </style>
</head>
<body class="bg-stone-50 text-slate-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col sm:flex-row justify-between items-center">
                <h1 class="text-2xl font-bold text-slate-800 mb-2 sm:mb-0">South Korea Expedition Planner</h1>
                <nav id="main-nav" class="flex flex-wrap justify-center gap-2 sm:gap-4">
                    <button data-tab="overview" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Overview</button>
                    <button data-tab="itinerary" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Itinerary</button>
                    <button data-tab="events" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Events</button>
                    <button data-tab="logistics" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Logistics</button>
                    <button data-tab="food" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Food Guide</button>
                    <button data-tab="culture" class="nav-tab px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent hover:text-amber-600 hover:border-amber-600 transition">Culture</button>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 md:p-8">
        
        <section id="overview" class="section">
            <div class="bg-white p-8 rounded-xl shadow-lg text-center">
                <h2 class="text-3xl font-bold text-amber-600 mb-4">Your AI-Powered South Korea Adventure!</h2>
                <p class="text-slate-600 max-w-3xl mx-auto mb-6">
                    Welcome to your personalized, multi-city guide to South Korea! This dynamic planner covers your journey from Nashville to Seoul, Gyeongju, and Busan. It's now updated with images, videos, and a special events tab to help you visualize and plan your trip.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
                    <div class="bg-stone-100 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-2 text-slate-700">Trip Details</h3>
                        <p><strong>Destinations:</strong> Nashville, Seoul, Gyeongju, Busan</p>
                        <p><strong>Duration:</strong> 8 Days / 7 Nights</p>
                        <p><strong>Travel Dates:</strong> Oct 4th - Oct 11th</p>
                        <p><strong>Travelers:</strong> 3 (2 Adults, 1 Child)</p>
                    </div>
                    <div class="bg-stone-100 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-2 text-slate-700">Recommended Basecamps</h3>
                        <p><strong>Seoul:</strong> Myeongdong</p>
                        <p><strong>Gyeongju:</strong> Downtown near bus terminal</p>
                        <p><strong>Busan:</strong> Haeundae Beach area</p>
                    </div>
                    <div class="bg-stone-100 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-2 text-slate-700">How to Use This Guide</h3>
                        <p>Click the tabs to switch sections. The 'Itinerary' tab now includes images and video links. Check the new 'Events' tab for the spectacular Jinju Lantern Festival!</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="itinerary" class="section">
            <div class="bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-center mb-2 text-amber-600">Daily Expedition Plan</h2>
                <p class="text-slate-600 text-center max-w-3xl mx-auto mb-8">
                    This is your day-by-day guide to Nashville and South Korea. Click a day to reveal the plan, now with images and video links to give you a preview of your adventures!
                </p>
                <div id="itinerary-container" class="space-y-4"></div>
            </div>
        </section>
        
        <section id="events" class="section">
            <div class="bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-center mb-2 text-amber-600">🎉 Special Events & Festivals</h2>
                <p class="text-slate-600 text-center max-w-3xl mx-auto mb-8">
                    Your travel dates coincide with one of South Korea's most beautiful festivals. This is a fantastic opportunity to witness something truly special.
                </p>
                <div class="max-w-4xl mx-auto bg-stone-50 rounded-lg p-6">
                    <h3 class="text-2xl font-bold text-slate-800 mb-3">Jinju Namgang Yudeung (Lantern) Festival</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <img src="https://placehold.co/800x600/1e3a8a/ffffff?text=Jinju+Lantern+Festival" class="rounded-lg shadow-md mb-4" alt="Colorful lanterns floating on a river at night.">
                            <p class="text-slate-600">Held annually in the city of Jinju, this festival is a breathtaking spectacle of thousands of intricate, illuminated lanterns floating on the Namgang River. It commemorates a historic battle where lanterns were used as military signals.</p>
                            <p class="text-slate-600 mt-2"><strong>Dates:</strong> Early to mid-October (confirm exact 2025 dates on their website).</p>
                            <p class="text-slate-600 mt-2"><strong>Recommendation:</strong> I have adjusted Day 5 of the itinerary to include an evening trip from Busan to Jinju. It's about a 1.5-hour bus ride, making it a very feasible and highly recommended excursion to witness this magical event.</p>
                            <div class="mt-4">
                                <button class="video-btn bg-amber-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-amber-600 transition" data-video-id="G_e42p9D_aM" data-video-title="Jinju Lantern Festival">Watch Festival Video</button>
                            </div>
                        </div>
                        <div class="flex flex-col">
                             <iframe class="rounded-lg shadow-md w-full h-full" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d105261.5948332152!2d128.0124483431535!3d35.18561434195191!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x356e1a4764436573%3A0x1b5e432c6645851d!2sJinju%2C%20Gyeongsangnam-do%2C%20South%20Korea!5e0!3m2!1sen!2sus!4v1723381000000!5m2!1sen!2sus" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="logistics" class="section">
             <div class="bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-center mb-2 text-amber-600">Arrival & Logistics Blueprint</h2>
                <p class="text-slate-600 text-center max-w-3xl mx-auto mb-8">
                    A smooth journey starts with solid planning. This section covers the essential logistics for your arrival and for navigating South Korea like a pro.
                </p>
                <div class="space-y-8">
                    <div>
                        <h3 class="text-2xl font-semibold mb-4 text-slate-700">Incheon Airport to Myeongdong</h3>
                        <p class="text-slate-600 mb-6">For a family arriving with luggage after a long flight, the <strong class="text-amber-700">Airport Limousine Bus</strong> is the top recommendation. The chart below compares options.</p>
                        <div class="chart-container bg-stone-50 p-4 rounded-lg">
                            <canvas id="transport-chart"></canvas>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-8 pt-8">
                        <div class="bg-stone-100 p-6 rounded-lg">
                           <h3 class="text-2xl font-semibold mb-3 text-slate-700">Connectivity & Transit</h3>
                           <p class="text-slate-600">An <strong class="text-amber-700">eSIM</strong> for each adult is essential for navigation. The <strong class="text-amber-700">WOWPASS</strong> card is the best all-in-one tool for currency exchange, debit payments, and public transit.</p>
                           <p class="mt-2 text-slate-600">Pre-order both from sites like <a href="https://www.klook.com/en-US/" target="_blank" class="location-link">Klook</a> for easy airport pickup.</p>
                        </div>
                        <div class="bg-stone-100 p-6 rounded-lg">
                           <h3 class="text-2xl font-semibold mb-3 text-slate-700">Inter-City Travel: KTX & Buses</h3>
                           <p class="text-slate-600">The <strong class="text-amber-700">KTX high-speed train</strong> is best for long distances (Seoul-Gyeongju-Busan). Book tickets in advance on the <a href="https://www.letskorail.com/ebizbf/EbizBfTicketSearch.do" target="_blank" class="location-link">Korail website</a>.</p>
                           <p class="text-slate-600 mt-2">For shorter trips like Busan to Jinju, express buses are frequent and comfortable. Tickets can be bought at the bus terminal.</p>
                        </div>
                         <div class="bg-stone-100 p-6 rounded-lg md:col-span-2">
                           <h3 class="text-2xl font-semibold mb-3 text-slate-700">Luggage Storage Strategy</h3>
                           <p class="text-slate-600">For your day trip to Gyeongju, you'll be traveling between Seoul and Busan. To avoid carrying all your luggage, use the <strong class="text-amber-700">lockers at Singyeongju KTX station</strong>. They are modern, automated, and can be operated with a credit card or T-money. Store your main bags upon arrival, explore Gyeongju with just a small daypack, and retrieve your luggage before catching your evening train to Busan. This is a crucial step for a comfortable and efficient day.</p>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold mb-4 mt-8 text-slate-700">Hotel Recommendations</h3>
                        <div id="hotel-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="food" class="section">
             <div class="bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-center mb-2 text-amber-600">A Culinary Field Guide</h2>
                 <p class="text-slate-600 text-center max-w-3xl mx-auto mb-6">
                    South Korea is a food lover's paradise. This guide introduces you to essential Korean dishes. Use the filters to sort dishes by spice level to find the perfect meal.
                </p>
                <div id="food-filters" class="flex justify-center gap-2 mb-8 flex-wrap">
                    <button data-filter="all" class="food-filter-btn px-4 py-2 text-sm font-medium rounded-full transition bg-amber-500 text-white">All</button>
                    <button data-filter="1" class="food-filter-btn px-4 py-2 text-sm font-medium rounded-full transition bg-stone-200 text-slate-700 hover:bg-stone-300">Mild (🌶️)</button>
                    <button data-filter="2-3" class="food-filter-btn px-4 py-2 text-sm font-medium rounded-full transition bg-stone-200 text-slate-700 hover:bg-stone-300">Medium (🌶️🌶️)</button>
                    <button data-filter="4" class="food-filter-btn px-4 py-2 text-sm font-medium rounded-full transition bg-stone-200 text-slate-700 hover:bg-stone-300">Spicy (🌶️🌶️🌶️)</button>
                </div>
                <div id="food-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </section>

        <section id="culture" class="section">
            <div class="bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-center mb-2 text-amber-600">✨ AI Culture Guide</h2>
                <p class="text-slate-600 text-center max-w-3xl mx-auto mb-8">
                    Have a question about Korean culture, etiquette, or language? Ask your AI guide! Whether you're wondering about tipping customs or how to say "hello," get instant, helpful answers for your trip.
                </p>
                <div class="max-w-2xl mx-auto">
                    <div class="flex gap-2">
                        <input type="text" id="culture-question-input" class="flex-grow border border-slate-300 rounded-lg p-3 focus:ring-2 focus:ring-amber-500 focus:outline-none" placeholder="e.g., How do I say 'thank you'?">
                        <button id="ask-culture-btn" class="bg-amber-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-amber-600 transition">Ask</button>
                    </div>
                    <div id="culture-answer-container" class="mt-6 bg-stone-50 p-6 rounded-lg min-h-[100px] text-slate-700 whitespace-pre-wrap">
                        Your answer will appear here...
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div id="video-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-2">
                <h3 id="video-modal-title" class="text-xl font-bold text-slate-800">Video Preview</h3>
                <button id="video-modal-close-btn" class="text-3xl text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div id="video-modal-body" class="video-container">
                <!-- YouTube iframe will be injected here -->
            </div>
        </div>
    </div>
    
    <script>
        const itineraryData = [
             {
                day: 0,
                date: "Fri, Oct 4",
                theme: "Travel Day & Nashville Night",
                icon: "🎸",
                plan: [
                    { time: "4:00 PM", activity: "Depart from Atlanta", description: "Travel from Atlanta to Nashville." },
                    { time: "Evening", activity: "Nashville Dinner & Music", description: "Check into a hotel near Nashville Airport (BNA). For dinner, take a short rideshare to the Gulch neighborhood for great food options like Biscuit Love or a classic meal at Puckett's Grocery & Restaurant, which often has live music. Head back to the hotel for a good night's sleep before your early flight.", image: "https://placehold.co/800x600/4f46e5/ffffff?text=Nashville+Gulch", videoId: "_k5-8V4R-kQ" }
                ]
            },
            {
                day: 1,
                date: "Sat, Oct 5",
                theme: "Journey to Seoul",
                icon: "✈️",
                plan: [
                    { time: "7:34 AM", activity: "Depart from Nashville (BNA)", description: "Begin your long-haul journey to Seoul!" },
                    { time: "All Day", activity: "In Transit", description: "Cross the International Date Line. Rest up on the plane!" }
                ]
            },
            {
                day: 2,
                date: "Sun, Oct 6",
                theme: "Seoul Arrival & Myeongdong",
                icon: "✨",
                plan: [
                    { time: "4:00 PM", activity: "Arrive at Incheon (ICN)", description: "Welcome to South Korea! Clear immigration, pick up your pre-ordered eSIMs and WOWPASS cards." },
                    { time: "5:30 PM", activity: "Transfer to Myeongdong", description: "Take the comfortable Airport Limousine Bus directly to your hotel." },
                    { time: "7:00 PM", activity: "Hotel Check-in & Refresh", description: "Settle into your room and take a moment to relax." },
                    { time: "8:00 PM onwards", activity: "Myeongdong Night Market", description: "Dive into the vibrant atmosphere for a late dinner, sampling street foods like Tornado Potato and Grilled Cheese Lobster.", link: "https://english.visitkorea.or.kr/enu/ATR/SI_EN_3_1_1_1.jsp?cid=264312", image: "https://placehold.co/800x600/f59e0b/ffffff?text=Myeongdong+Market", videoId: "cKLPy5C4sMk" }
                ]
            },
            {
                day: 3,
                date: "Mon, Oct 7",
                theme: "Seoul's Royal Heart",
                icon: "🏯",
                plan: [
                    { time: "9:00 AM - 1:00 PM", activity: "Gyeongbokgung Palace", description: "Explore the grandest of Seoul's five palaces. Don't miss the Royal Guard Changing Ceremony at 10 AM.", link: "https://www.royalpalace.go.kr/content/guide/guide01_tab01.asp", image: "https://placehold.co/800x600/166534/ffffff?text=Gyeongbokgung+Palace", videoId: "d_645wW2s4s" },
                    { time: "1:00 PM", activity: "Lunch in Insadong", description: "Enjoy a traditional meal in the Insadong neighborhood, known for its art galleries and teahouses." },
                    { time: "2:30 PM - 5:00 PM", activity: "Bukchon Hanok Village", description: "Wander through the picturesque alleys of a traditional Korean residential village.", link: "https://hanok.seoul.go.kr/front/eng/index.do", image: "https://placehold.co/800x600/a16207/ffffff?text=Bukchon+Hanok+Village", videoId: "s33i1g0o38E" },
                    { time: "5:00 PM onwards", activity: "Namsan Tower at Sunset", description: "Take the Namsan Cable Car up before sunset to see the city view transform from day to night.", link: "https://www.nseoultower.co.kr/eng/", image: "https://placehold.co/800x600/be185d/ffffff?text=Namsan+Seoul+Tower", videoId: "LwG4f_c1G-Y" }
                ]
            },
            {
                day: 4,
                date: "Tue, Oct 8",
                theme: "Gyeongju: The Golden Kingdom",
                icon: "🏛️",
                plan: [
                    { time: "8:00 AM", activity: "KTX to Gyeongju", description: "Take the high-speed KTX train from Seoul Station to Singyeongju Station (approx. 2 hours). Store luggage in station lockers." },
                    { time: "11:00 AM", activity: "Bulguksa Temple", description: "Visit one of Korea's most famous and beautiful Buddhist temples, a UNESCO World Heritage site.", link: "http://www.bulguksa.or.kr/eng_main/", image: "https://placehold.co/800x600/059669/ffffff?text=Bulguksa+Temple", videoId: "v-p8d7s-sJg" },
                    { time: "2:00 PM", activity: "Seokguram Grotto", description: "Take a short bus or taxi ride up the mountain to see the magnificent stone Buddha statue in this man-made grotto, another UNESCO site." },
                    { time: "4:00 PM onwards", activity: "Daereungwon Tomb Complex", description: "Explore the giant, grassy burial mounds of the Silla kings. Check into your Gyeongju hotel and have dinner downtown.", image: "https://placehold.co/800x600/4d7c0f/ffffff?text=Gyeongju+Tombs", videoId: "tNueL3q66s4" }
                ]
            },
            {
                day: 5,
                date: "Wed, Oct 9",
                theme: "Busan & Jinju Lantern Festival",
                icon: "🌊",
                plan: [
                    { time: "9:30 AM", activity: "KTX to Busan", description: "Take a short KTX ride (approx. 30 mins) from Singyeongju to Busan Station. Check into your hotel in the Haeundae area." },
                    { time: "1:00 PM", activity: "Gamcheon Culture Village", description: "Explore the famously colorful and artistic village built on the mountainside, known as the 'Machu Picchu of Busan'.", link: "http://www.gamcheon.or.kr/", image: "https://placehold.co/800x600/0284c7/ffffff?text=Gamcheon+Village", videoId: "I_k5a-dY4Yo" },
                    { time: "4:00 PM", activity: "Travel to Jinju", description: "Take a 1.5-hour express bus from Busan Seobu Bus Terminal to Jinju for the festival." },
                    { time: "Evening", activity: "Jinju Namgang Yudeung Festival", description: "Witness the breathtaking spectacle of thousands of lanterns floating on the river. Enjoy festival food for dinner before taking a late bus back to Busan." }
                ]
            },
            {
                day: 6,
                date: "Thu, Oct 10",
                theme: "Markets, Temples & Return to Seoul",
                icon: "市場",
                plan: [
                    { time: "10:00 AM", activity: "Jagalchi Fish Market", description: "Experience the sights and sounds of Korea's largest seafood market. Be brave and try some fresh raw fish!", link: "https://www.jagalchimarket.or.kr/jp/", image: "https://placehold.co/800x600/0891b2/ffffff?text=Jagalchi+Fish+Market", videoId: "y4yQ2nI7Y5w" },
                    { time: "12:30 PM", activity: "Haedong Yonggungsa Temple", description: "Visit the stunning seaside Buddhist temple, one of the few in Korea located on the coast.", link: "http://www.yongkungsa.or.kr/", image: "https://placehold.co/800x600/0d9488/ffffff?text=Seaside+Temple", videoId: "s_c-yI0G9A0" },
                    { time: "4:00 PM", activity: "KTX to Seoul", description: "Take the KTX from Busan Station back to Seoul Station (approx. 2.5-3 hours)." },
                    { time: "7:00 PM", activity: "Final Dinner in Seoul", description: "Enjoy a final Korean BBQ meal or revisit a favorite spot in Myeongdong." }
                ]
            },
            {
                day: 7,
                date: "Fri, Oct 11",
                theme: "Lasting Impressions & Departure",
                icon: "✈️",
                plan: [
                    { time: "Morning", activity: "Last-Minute Souvenirs", description: "Do some final shopping in Myeongdong or visit the HiKR Ground for some interactive K-Culture fun.", link: "https://english.visitkorea.or.kr/enu/ATR/SI_EN_3_1_1_1.jsp?cid=2843093", image: "https://placehold.co/800x600/6d28d9/ffffff?text=HiKR+Ground", videoId: "Z4paKAlG4_A" },
                    { time: "1:00 PM", activity: "Final Lunch", description: "Have a last meal in Myeongdong. Try the famous and delicious Isaac Toast sandwiches." },
                    { time: "2:00 PM", activity: "Head to Airport", description: "Be at an Airport Limousine Bus stop by 2 PM for your 6 PM flight. This allows ample time for travel, check-in, and tax refund processing." }
                ]
            }
        ];

        const hotelData = [
            { name: "Lotte Hotel Seoul", tier: "Luxury", rooms: "Family Twin Rooms", feature: "Ultimate luxury, connected to shopping", link: "https://www.lottehotel.com/seoul-hotel/en.html" },
            { name: "Pacific Hotel", tier: "Upper Mid-Range", rooms: "Triple / Family Rooms", feature: "Excellent location, classic comfort", link: "https://www.thepacifichotel.co.kr/en/" },
            { name: "Hotel Skypark Central", tier: "Mid-Range", rooms: "Triple / Family Rooms", feature: "Heart of the action, rooftop patio", link: "https://www.skyparkhotel.com/html/main.asp" },
            { name: "Orakai Insadong Suites", tier: "Aparthotel", rooms: "1-Bedroom Suites", feature: "Maximum space, kitchen, pool", link: "https://www.orakaihotels.com/insadong/en/main" }
        ];

        const foodData = [
            { name: "Kimchi Jjigae", description: "A rich, hearty, and spicy stew made with aged kimchi, tofu, and pork.", spice: 4 },
            { name: "Samgyetang", description: "A whole young chicken stuffed with glutinous rice, ginseng, and jujubes, served in a delicate broth.", spice: 1 },
            { name: "Bibimbap", description: "A bowl of warm rice topped with an array of seasoned vegetables, meat, and a fried egg, mixed with chili paste.", spice: 3 },
            { name: "Bulgogi", description: "Thinly sliced beef marinated in a sweet soy sauce and grilled. A non-spicy favorite.", spice: 1 },
            { name: "Japchae", description: "Savory and slightly sweet stir-fried glass noodles with vegetables and meat.", spice: 1 },
            { name: "Tteokbokki", description: "Chewy rice cakes and fish cakes simmered in a sweet and spicy red chili sauce.", spice: 4 },
            { name: "Bindaetteok", description: "A savory, crispy pancake made from ground mung beans, often with vegetables and meat.", spice: 1 },
            { name: "Kalguksu", description: "Hearty, handmade, knife-cut wheat noodles served in a rich broth, often with seafood or chicken.", spice: 1 },
            { name: "Samgyeopsal", description: "Thick slices of unmarinated pork belly grilled at the table. The quintessential K-BBQ experience.", spice: 1 },
            { name: "Naengmyeon", description: "A refreshing dish of chewy buckwheat noodles served in a chilled broth, perfect for warmer days.", spice: 1 },
            { name: "Hotteok", description: "A sweet, griddled pancake filled with a mixture of brown sugar, cinnamon, and nuts.", spice: 1 }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const itineraryContainer = document.getElementById('itinerary-container');
            const hotelContainer = document.getElementById('hotel-container');
            const foodContainer = document.getElementById('food-container');
            const foodFilters = document.getElementById('food-filters');
            const mainNav = document.getElementById('main-nav');
            const sections = document.querySelectorAll('.section');
            const tabs = document.querySelectorAll('.nav-tab');
            const videoModal = document.getElementById('video-modal');
            const videoModalTitle = document.getElementById('video-modal-title');
            const videoModalBody = document.getElementById('video-modal-body');
            const videoModalCloseBtn = document.getElementById('video-modal-close-btn');
            const askCultureBtn = document.getElementById('ask-culture-btn');
            const cultureQuestionInput = document.getElementById('culture-question-input');
            const cultureAnswerContainer = document.getElementById('culture-answer-container');

            const apiKey = ""; 

            async function callGeminiAPI(prompt, maxRetries = 3) {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };

                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                            return result.candidates[0].content.parts[0].text;
                        } else {
                            throw new Error("Invalid response structure from API.");
                        }
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            console.error("API call failed after multiple retries:", error);
                            return "Sorry, I couldn't get a response. Please check the API key and try again.";
                        }
                        const delay = Math.pow(2, i) * 1000;
                        await new Promise(res => setTimeout(res, delay));
                    }
                }
            }

            function showVideoModal(title, videoId) {
                videoModalTitle.textContent = title;
                videoModalBody.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                videoModal.classList.add('visible');
            }

            function closeVideoModal() {
                videoModal.classList.remove('visible');
                videoModalBody.innerHTML = '';
            }

            function showLoader() {
                return '<div class="flex justify-center items-center"><div class="loader"></div></div>';
            }

            async function handleCultureQuestion() {
                const question = cultureQuestionInput.value.trim();
                if (!question) {
                    cultureAnswerContainer.textContent = "Please enter a question first.";
                    return;
                }

                cultureAnswerContainer.innerHTML = showLoader();
                const prompt = `As a friendly guide for a tourist in South Korea, please answer this question clearly and concisely: "${question}"`;
                
                const response = await callGeminiAPI(prompt);
                cultureAnswerContainer.textContent = response;
            }

            function renderItinerary() {
                itineraryContainer.innerHTML = itineraryData.map(day => `
                    <div class="border border-stone-200 rounded-lg overflow-hidden">
                        <div class="day-card-header p-4 cursor-pointer flex justify-between items-center bg-stone-100 hover:bg-stone-200" data-day="${day.day}">
                            <div class="flex items-center">
                                <span class="text-2xl mr-4">${day.icon}</span>
                                <div>
                                    <h3 class="font-bold text-lg text-slate-800">Day ${day.day}: ${day.theme}</h3>
                                    <p class="text-sm text-slate-500">${day.date}</p>
                                </div>
                            </div>
                            <span class="text-2xl text-slate-400 transform transition-transform duration-500">&#x25BC;</span>
                        </div>
                        <div class="details-content">
                            <div class="p-4 border-t border-stone-200 bg-white">
                                <ul class="space-y-4">
                                    ${day.plan.map(item => `
                                        <li class="grid md:grid-cols-3 gap-4 items-start pt-2">
                                            <div class="md:col-span-2">
                                                <div class="flex items-start">
                                                    <strong class="w-24 text-right pr-4 font-semibold text-amber-600">${item.time}</strong>
                                                    <div class="flex-1">
                                                        <p class="font-semibold text-slate-700">${item.activity}</p>
                                                        <p class="text-sm text-slate-600">${item.description}
                                                        ${item.link ? `<a href="${item.link}" target="_blank" class="location-link ml-2">Learn More</a>` : ''}
                                                        </p>
                                                        ${item.videoId ? `<button class="video-btn mt-2 bg-amber-100 text-amber-800 text-xs font-semibold py-1 px-3 rounded-full hover:bg-amber-200 transition" data-video-id="${item.videoId}" data-video-title="${item.activity}">Watch Video</button>` : ''}
                                                    </div>
                                                </div>
                                            </div>
                                            ${item.image ? `<div class="md:col-span-1"><img src="${item.image}" class="rounded-lg shadow-md" alt="${item.activity}"></div>` : ''}
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            function renderHotels() {
                hotelContainer.innerHTML = hotelData.map(hotel => `
                    <div class="bg-stone-100 p-4 rounded-lg h-full flex flex-col">
                         <a href="${hotel.link}" target="_blank" class="flex-grow">
                            <h4 class="font-bold text-md text-slate-800 hover:text-amber-700">${hotel.name}</h4>
                            <p class="text-sm text-amber-700 font-semibold mb-1">${hotel.tier}</p>
                            <p class="text-sm text-slate-600">${hotel.feature}</p>
                        </a>
                        <p class="text-xs mt-2 bg-white text-slate-500 rounded-full px-2 py-1 self-start">${hotel.rooms}</p>
                    </div>
                `).join('');
            }
            
            function renderFood(filter = 'all') {
                const filteredData = foodData.filter(item => {
                    if (filter === 'all') return true;
                    if (filter === '2-3') return item.spice >= 2 && item.spice <= 3;
                    return item.spice == filter;
                });

                foodContainer.innerHTML = filteredData.map(food => `
                    <div class="bg-stone-100 p-4 rounded-lg">
                        <div class="flex justify-between items-start mb-2">
                             <h4 class="font-bold text-lg text-slate-800">${food.name}</h4>
                             <span class="text-lg">${'🌶️'.repeat(food.spice)}</span>
                        </div>
                        <p class="text-slate-600 text-sm">${food.description}</p>
                    </div>
                `).join('');
            }

            function createTransportChart() {
                const ctx = document.getElementById('transport-chart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Airport Limousine Bus', 'AREX + Subway', 'Taxi'],
                        datasets: [
                            {
                                label: 'Estimated Cost (KRW for 3)',
                                data: [51000, 32700, 85000],
                                backgroundColor: 'rgba(245, 158, 11, 0.6)',
                                borderColor: 'rgba(245, 158, 11, 1)',
                                borderWidth: 1,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Estimated Time (minutes)',
                                data: [82, 68, 75],
                                backgroundColor: 'rgba(100, 116, 139, 0.6)',
                                borderColor: 'rgba(100, 116, 139, 1)',
                                borderWidth: 1,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) { label += ': '; }
                                        if (context.parsed.y !== null) {
                                            if(context.dataset.label.includes('Cost')){
                                                label += new Intl.NumberFormat('ko-KR', { style: 'currency', currency: 'KRW' }).format(context.parsed.y);
                                            } else {
                                                label += context.parsed.y + ' min';
                                            }
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { type: 'linear', display: true, position: 'left', title: { display: true, text: 'Cost (KRW)' } },
                            y1: { type: 'linear', display: true, position: 'right', title: { display: true, text: 'Time (min)' }, grid: { drawOnChartArea: false } }
                        }
                    }
                });
            }
            
            document.body.addEventListener('click', e => {
                const dayHeader = e.target.closest('.day-card-header');
                if (dayHeader) {
                    const content = dayHeader.nextElementSibling;
                    const arrow = dayHeader.querySelector('span:last-child');
                    content.classList.toggle('open');
                    arrow.classList.toggle('rotate-180');
                }

                const videoBtn = e.target.closest('.video-btn');
                if (videoBtn) {
                    showVideoModal(videoBtn.dataset.videoTitle, videoBtn.dataset.videoId);
                }
            });

            foodFilters.addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    document.querySelectorAll('.food-filter-btn').forEach(btn => {
                        btn.classList.remove('bg-amber-500', 'text-white');
                        btn.classList.add('bg-stone-200', 'text-slate-700');
                    });
                    e.target.classList.add('bg-amber-500', 'text-white');
                    e.target.classList.remove('bg-stone-200', 'text-slate-700');
                    renderFood(e.target.dataset.filter);
                }
            });
            
            mainNav.addEventListener('click', e => {
                if (e.target.classList.contains('nav-tab')) {
                    const tabName = e.target.dataset.tab;
                    tabs.forEach(tab => tab.classList.remove('tab-active'));
                    e.target.classList.add('tab-active');
                    sections.forEach(section => section.classList.toggle('active', section.id === tabName));
                }
            });

            videoModalCloseBtn.addEventListener('click', closeVideoModal);
            videoModal.addEventListener('click', e => {
                if (e.target === videoModal) {
                    closeVideoModal();
                }
            });
            askCultureBtn.addEventListener('click', handleCultureQuestion);
            cultureQuestionInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') {
                    handleCultureQuestion();
                }
            });

            function initialize() {
                renderItinerary();
                renderHotels();
                renderFood();
                createTransportChart();
                document.querySelector('.nav-tab[data-tab="overview"]').classList.add('active');
                document.getElementById('overview').classList.add('active');
            }

            initialize();
        });
    </script>
</body>
</html>
